!function(t){function e(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var r={};return e.m=t,e.c=r,e.i=function(t){return t},e.d=function(t,r,n){e.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="./",e(e.s=7)}([function(t,e,r){"use strict";function n(t,e){function r(){var t=2*Math.pow(2,Math.floor(Math.log2(Math.min(window.innerWidth,window.innerHeight))));n.width=t,n.height=t,n.style.width=t/2+"px",n.style.height=t/2+"px",i.viewport(0,0,n.width,n.height)}var n=(document.body,document.querySelector("canvas")),i=n.getContext("webgl2");r(),window.addEventListener("resize",r),i.clearColor(0,0,0,1),i.clear(i.COLOR_BUFFER_BIT);var o=i.createShader(i.VERTEX_SHADER);if(i.shaderSource(o,t),i.compileShader(o),!i.getShaderParameter(o,i.COMPILE_STATUS))throw new Error("An error occurred compiling the shader: "+i.getShaderInfoLog(o));console.log("Vertex shader compiled");var a=i.createShader(i.FRAGMENT_SHADER);if(i.shaderSource(a,e),i.compileShader(a),!i.getShaderParameter(a,i.COMPILE_STATUS))throw new Error("An error occurred compiling the shader: "+i.getShaderInfoLog(a));console.log("Fragment shader compiled");var u=i.createProgram();if(i.attachShader(u,o),i.attachShader(u,a),i.linkProgram(u),!i.getProgramParameter(u,i.LINK_STATUS))throw new Error("Unable to initialize the shader program.");return console.log("Initialized shader program"),i.useProgram(u),{gl:i,shaderProgram:u}}function i(){var t=document.querySelector("canvas").getContext("webgl2"),e=t.createTexture();return t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT),t.bindTexture(t.TEXTURE_2D,null),e}Object.defineProperty(e,"__esModule",{value:!0}),e.createProgram=n,e.createTexture=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n={vertexSource:"#version 300 es\n\t\tprecision highp float;\n\t\tin vec3 aPosition;\n\t\tout vec2 vTexturePosition;\n\t\tout vec2 vPosition;\n\t\tvoid main(void) {\n\t\t\tvPosition = aPosition.xy;\n\t\t\tvTexturePosition = vec2(aPosition.x + 1.0, -1.0 + aPosition.y) * 0.5;\n\t\t\tgl_Position = vec4(aPosition, 1.0);\n\t\t}\n\t"};e.default=n},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(){d.incrementState(),h.draw(d.stateTexture()),requestAnimationFrame(i)}var o=(r(0),r(6)),a=n(o),u=r(5),s=n(u),f=r(4),l=n(f),c=r(3),v=n(c);console.log("üê≠");var d=new a.default({shaderSource:l.default}),h=new s.default({shaderSource:v.default}),T=document.querySelector("canvas").getContext("webgl2");T.clearColor(0,0,0,1),T.clear(T.COLOR_BUFFER_BIT);var m=[];console.time("Init");for(var E=0;E<T.canvas.width;E++)for(var R=0;R<T.canvas.height;R++)Math.random()<.35?(m[4*(R*T.canvas.width+E)]=255,m[4*(R*T.canvas.width+E)+1]=0,m[4*(R*T.canvas.width+E)+2]=0,m[4*(R*T.canvas.width+E)+3]=255):(m[4*(R*T.canvas.width+E)]=0,m[4*(R*T.canvas.width+E)+1]=0,m[4*(R*T.canvas.width+E)+2]=0,m[4*(R*T.canvas.width+E)+3]=255);d.setState(new ImageData(new Uint8ClampedArray(m),T.canvas.width,T.canvas.height)),console.timeEnd("Init");requestAnimationFrame(i)},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=r(1),o=n(i),a={vertexSource:o.default.vertexSource,fragmentSource:"#version 300 es\n\t\tprecision highp float;\n\t\tuniform sampler2D uSampler;\n\t\tin vec2 vTexturePosition;\n\t\tin vec2 vPosition;\n\t\tout vec4 fragmentColor;\n\n\t\tbool isLive(vec2 offset) {\n\t\t\t\tvec4 stateColor = texture(uSampler, vTexturePosition + offset);\n\t\t\t\tif (stateColor.r == 1.0) {\n\t\t\t\t\treturn true;\n\t\t\t\t} else {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t}\n\n\t\tbool radiusIsLive(int radius) {\n\t\t\tivec2 size = textureSize(uSampler, 0);\n\t\t\tfloat stepX = 1.0/float(size.x);\n\t\t\tfloat stepY = 1.0/float(size.y);\n\t\t\tint side = 2*radius + 1;\n\n\n\t\t\tfor (int x = 0; x < side; x++) {\n\t\t\t\tfor (int y = 0; y < side; y++) {\n\t\t\t\t\tif (isLive(vec2(stepX * float(-radius + x), stepY * float(-radius + y)))) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false;\n\t\t\t//Top\n\t\t\tfor (int i = 0; i < side; i++) {\n\t\t\t\tif (isLive(vec2(stepX * float(-radius + i), stepY * float(-radius)))) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//Left\n\t\t\tfor (int i = 0; i < side; i++) {\n\t\t\t\tif (isLive(vec2(stepX * float(-radius), - stepY * float(-radius + i)))) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//Right\n\t\t\tfor (int i = 0; i < side; i++) {\n\t\t\t\tif (isLive(vec2(stepX * float(radius), - stepY * float(-radius + i)))) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//Bottom\n\t\t\tfor (int i = 0; i < side; i++) {\n\t\t\t\tif (isLive(vec2(stepX * float(-radius + i), stepY * float(radius)))) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn false;\n\n\t\t}\n\n\t\tvoid main(void) {\n\t\t\t// fragmentColor = texture(uSampler, vTexturePosition);\n\t\t\t// return;\n\n\t\t\tivec2 size = textureSize(uSampler, 0);\n\t\t\tfloat stepX = 1.0/float(size.x);\n\t\t\tfloat stepY = 1.0/float(size.y);\n\t\t\tif (radiusIsLive(5)) {\n\t\t\t\t\tfragmentColor = vec4(1.0, 1.0, 1.0, 1.0);\n\t\t\t\t\treturn;\n\t\t\t} else {\n\t\t\t\tfragmentColor = vec4(0.0, 0.0, 0.0, 1.0);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// fragmentColor = (\n\t\t\t// \ttexture(uSampler, vTexturePosition) +\n\t\t\t// \ttexture(uSampler, vTexturePosition - vec2(stepX, stepY)) +\n\t\t\t// \ttexture(uSampler, vTexturePosition - vec2(-stepX, stepY)) +\n\t\t\t// \ttexture(uSampler, vTexturePosition - vec2(stepX, -stepY)) +\n\t\t\t// \ttexture(uSampler, vTexturePosition - vec2(-stepX, -stepY))\n\t\t\t// )/5.0;\n\t\t}\n\t"};e.default=a},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=r(1),o=n(i),a={vertexSource:o.default.vertexSource,fragmentSource:"#version 300 es\n\t\tprecision highp float;\n\t\tuniform sampler2D uSampler;\n\t\tin vec2 vTexturePosition;\n\t\tin vec2 vPosition;\n\t\tuniform vec2 uMousePosition;\n\t\tuniform highp float uWidth;\n\t\tuniform int uShouldUpdate;\n\t\tout vec4 fragmentColor;\n\n\t\tbool isLive(vec2 offset) {\n\t\t\t\tvec4 lastColor = texture(uSampler, vTexturePosition + offset);\n\t\t\t\tif (lastColor.r == 1.0) {\n\t\t\t\t\treturn true;\n\t\t\t\t} else {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t}\n\n\t\tvoid main(void) {\n\t\t\tvec4 lastColor = texture(uSampler, vTexturePosition);\n\n\t\t\tif (uShouldUpdate == 0) {\n\t\t\t\tfragmentColor = lastColor;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tfloat d = distance(uMousePosition, vPosition);\n\t\t\tif (d < 2.0/uWidth) {\n\t\t\t\tfragmentColor = vec4(1.0, 0, 0, 1.0);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tint liveCount = 0;\n\t\t\tfloat step = 1.0/uWidth;\n\n\t\t\tif (isLive(vec2(-step, -step))) {liveCount++;}\n\t\t\tif (isLive(vec2(-step, 0))) {liveCount++;}\n\t\t\tif (isLive(vec2(-step, step))) {liveCount++;}\n\t\t\tif (isLive(vec2(0, -step))) {liveCount++;}\n\t\t\tif (isLive(vec2(0, step))) {liveCount++;}\n\t\t\tif (isLive(vec2(step, -step))) {liveCount++;}\n\t\t\tif (isLive(vec2(step, 0))) {liveCount++;}\n\t\t\tif (isLive(vec2(step, step))) {liveCount++;}\n\n\t\t\t// if (liveCount < 2) {\n\t\t\t// \tfragmentColor = vec4(1.0, 0, 0, 1.0);\n\t\t\t// } else if (liveCount < 4) {\n\t\t\t// \tfragmentColor = vec4(0, 1.0, 0, 1.0);\n\t\t\t// } else if (liveCount < 8) {\n\t\t\t// \tfragmentColor = vec4(0, 0, 1.0, 1.0);\n\t\t\t// } else {\n\t\t\t// \tfragmentColor = vec4(1.0, 0, 1.0, 1.0);\n\t\t\t// }\n\n\t\t\tbool selfIsLive = isLive(vec2(0,0));\n\t\t\tif (selfIsLive && (liveCount == 2 || liveCount == 3)) {\n\t\t\t\tif (lastColor.g < 1.0) {\n\t\t\t\t\tfragmentColor = lastColor + vec4(1.0, 0.01, 0.0, 1.0);\n\t\t\t\t} else {\n\t\t\t\t\tfragmentColor = lastColor + vec4(1.0, 0.0, 0.01, 1.0);\n\t\t\t\t}\n\t\t\t} else if (!selfIsLive && (liveCount == 3)) {\n\t\t\t\tfragmentColor = vec4(1.0, 0, 0, 1.0);\n\t\t\t} else {\n\t\t\t\tfragmentColor = vec4(0.0, 0.0, 0.0, 0.8);\n\t\t\t}\n\t\t}\n\t"};e.default=a},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=r(0),a=function(){function t(e){var r=e.shaderSource;n(this,t);var i=(0,o.createProgram)(r.vertexSource,r.fragmentSource),a=i.gl,u=i.shaderProgram;this.gl=a,this.shaderProgram=u,this.currentState=0,this.vertexBuffer=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,this.vertexBuffer),this.vertices=[1,1,0,-1,1,0,1,-1,0,-1,-1,0],a.bufferData(a.ARRAY_BUFFER,new Float32Array(this.vertices),a.STATIC_DRAW);var s=a.getAttribLocation(u,"aPosition");a.enableVertexAttribArray(s),a.vertexAttribPointer(s,3,a.FLOAT,!1,0,0);var f=a.getUniformLocation(u,"uWidth");a.uniform1f(f,a.canvas.width)}return i(t,[{key:"draw",value:function(t){var e=this.gl;e.useProgram(this.shaderProgram),e.bindTexture(e.TEXTURE_2D,t),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.drawArrays(e.TRIANGLE_STRIP,0,this.vertices.length/3),e.bindBuffer(e.ARRAY_BUFFER,null),e.bindTexture(e.TEXTURE_2D,null)}}]),t}();e.default=a},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=r(0),a=function(){function t(e){var r=e.shaderSource;n(this,t);var i=(0,o.createProgram)(r.vertexSource,r.fragmentSource),a=i.gl,u=i.shaderProgram;this.gl=a,this.shaderProgram=u,this.currentState=0,this.vertexBuffer=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,this.vertexBuffer),this.vertices=[1,1,0,-1,1,0,1,-1,0,-1,-1,0],a.bufferData(a.ARRAY_BUFFER,new Float32Array(this.vertices),a.STATIC_DRAW);var s=a.getAttribLocation(u,"aPosition");a.enableVertexAttribArray(s),a.vertexAttribPointer(s,3,a.FLOAT,!1,0,0);var f=a.getUniformLocation(u,"uWidth");a.uniform1f(f,a.canvas.width),this.uShouldUpdate=a.getUniformLocation(u,"uShouldUpdate"),this.tTexture0=(0,o.createTexture)(),this.tTexture1=(0,o.createTexture)(),this.frameBuffer=a.createFramebuffer(),a.bindFramebuffer(a.FRAMEBUFFER,this.frameBuffer),this.frameBuffer.width=a.canvas.width,this.frameBuffer.height=a.canvas.height,a.bindTexture(a.TEXTURE_2D,this.tTexture1),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,this.frameBuffer.width,this.frameBuffer.height,0,a.RGBA,a.UNSIGNED_BYTE,null);var l=a.createRenderbuffer();a.bindRenderbuffer(a.RENDERBUFFER,l),a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_COMPONENT16,this.frameBuffer.width,this.frameBuffer.height),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,l),a.bindRenderbuffer(a.RENDERBUFFER,null),a.bindFramebuffer(a.FRAMEBUFFER,null)}return i(t,[{key:"setState",value:function(t){var e=this.gl;e.bindTexture(e.TEXTURE_2D,this.tTexture0),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),e.bindTexture(e.TEXTURE_2D,null)}},{key:"drawState",value:function(){var t=this.gl;t.useProgram(this.shaderProgram),t.uniform1i(this.uShouldUpdate,0),t.bindFramebuffer(t.FRAMEBUFFER,null),0==this.currentState?t.bindTexture(t.TEXTURE_2D,this.tTexture0):t.bindTexture(t.TEXTURE_2D,this.tTexture1),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.drawArrays(t.TRIANGLE_STRIP,0,this.vertices.length/3),t.bindBuffer(t.ARRAY_BUFFER,null)}},{key:"incrementState",value:function(){var t=this.gl;t.useProgram(this.shaderProgram),t.uniform1i(this.uShouldUpdate,1),t.bindFramebuffer(t.FRAMEBUFFER,this.frameBuffer),0==this.currentState?(t.bindTexture(t.TEXTURE_2D,this.tTexture0),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.tTexture1,0)):(t.bindTexture(t.TEXTURE_2D,this.tTexture1),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.tTexture0,0)),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.drawArrays(t.TRIANGLE_STRIP,0,this.vertices.length/3),t.bindBuffer(t.ARRAY_BUFFER,null),t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),this.currentState=(this.currentState+1)%2}},{key:"stateTexture",value:function(){return 0==this.currentState?this.tTexture0:this.tTexture1}}]),t}();e.default=a},function(t,e,r){t.exports=r(2)}]);
//# sourceMappingURL=index.js.map